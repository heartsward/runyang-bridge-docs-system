# æ¶¦æ‰¬å¤§æ¡¥è¿ç»´æ–‡æ¡£ç®¡ç†ç³»ç»Ÿ - é…ç½®æŒ‡å—

## ğŸ“‹ é…ç½®æ¦‚è§ˆ

æœ¬ç³»ç»Ÿæä¾›çµæ´»çš„é…ç½®é€‰é¡¹ï¼Œæ”¯æŒå¼€å‘ã€æµ‹è¯•å’Œç”Ÿäº§ç¯å¢ƒçš„ä¸åŒéœ€æ±‚ã€‚

### å¿«é€Ÿé…ç½®æ£€æŸ¥è¡¨

- [ ] **CORSé…ç½®** - è·¨åŸŸè¯·æ±‚è®¾ç½®
- [ ] **ç½‘ç»œé…ç½®** - IPåœ°å€å’Œç«¯å£è®¾ç½®  
- [ ] **åŸŸåé…ç½®** - è‡ªå®šä¹‰åŸŸåå’ŒHTTPS
- [ ] **å‰ç«¯é…ç½®** - æ„å»ºå’Œéƒ¨ç½²é€‰é¡¹
- [ ] **æ•°æ®åº“é…ç½®** - æ•°æ®å­˜å‚¨è®¾ç½®

---

## ğŸŒ CORSé…ç½®

### å¼€å‘ç¯å¢ƒï¼ˆæ¨èï¼‰
```env
# åœ¨ backend/.env ä¸­é…ç½®
CORS_MODE=auto
CORS_AUTO_DETECT=true
CORS_INCLUDE_LOCALHOST=true
CORS_FRONTEND_PORT=5173
```

### ç”Ÿäº§ç¯å¢ƒ
```env
# æ‰‹åŠ¨æŒ‡å®šå…è®¸çš„åŸŸå
CORS_MODE=manual
CORS_CUSTOM_ORIGINS=https://yourdomain.com,https://admin.yourdomain.com
```

### å±€åŸŸç½‘éƒ¨ç½²
```env
CORS_MODE=auto
CORS_AUTO_DETECT=true
CORS_INCLUDE_LOCALHOST=true
CORS_EXTRA_PORTS=3000,8080,9000
```

---

## ğŸ”§ ç½‘ç»œé…ç½®

### é»˜è®¤ç«¯å£
- **åç«¯API**: 8002
- **å‰ç«¯å¼€å‘**: 5173
- **å‰ç«¯ç”Ÿäº§**: 80/443

### è‡ªå®šä¹‰ç«¯å£
```env
# backend/app/core/config.py
SERVER_HOST = "0.0.0.0"
SERVER_PORT = 8002

# frontend/vite.config.ts
server: {
  port: 5173,
  host: true
}
```

### é˜²ç«å¢™é…ç½®
```bash
# Linuxé˜²ç«å¢™å¼€æ”¾ç«¯å£
sudo ufw allow 8002
sudo ufw allow 5173

# Windowsé˜²ç«å¢™
netsh advfirewall firewall add rule name="RunYang System" dir=in action=allow protocol=TCP localport=8002,5173
```

---

## ğŸŒ åŸŸåå’ŒHTTPSé…ç½®

### åŸŸåç»‘å®š
1. **DNSé…ç½®**
   ```
   Aè®°å½•: yourdomain.com -> æœåŠ¡å™¨IP
   Aè®°å½•: api.yourdomain.com -> æœåŠ¡å™¨IP
   ```

2. **Nginxé…ç½®ç¤ºä¾‹**
   ```nginx
   # /etc/nginx/sites-available/runyang-system
   server {
       listen 80;
       server_name yourdomain.com;
       
       # å‰ç«¯é™æ€æ–‡ä»¶
       location / {
           root /path/to/frontend/dist;
           try_files $uri $uri/ /index.html;
       }
       
       # APIä»£ç†
       location /api/ {
           proxy_pass http://localhost:8002;
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
       }
   }
   ```

3. **HTTPSè¯ä¹¦**
   ```bash
   # ä½¿ç”¨Let's Encrypt
   sudo certbot --nginx -d yourdomain.com
   ```

### å‰ç«¯åŸŸåé…ç½®
```typescript
// frontend/src/services/api.ts
const API_BASE_URL = import.meta.env.PROD 
  ? 'https://api.yourdomain.com'
  : 'http://localhost:8002';
```

---

## ğŸ¨ å‰ç«¯é…ç½®

### å¼€å‘ç¯å¢ƒ
```typescript
// frontend/vite.config.ts
export default defineConfig({
  server: {
    port: 5173,
    host: true,
    proxy: {
      '/api': {
        target: 'http://localhost:8002',
        changeOrigin: true
      }
    }
  }
})
```

### ç”Ÿäº§æ„å»º
```bash
# æ„å»ºä¼˜åŒ–
npm run build

# é¢„è§ˆæ„å»ºç»“æœ
npm run preview
```

### ç¯å¢ƒå˜é‡
```env
# frontend/.env.production
VITE_API_BASE_URL=https://api.yourdomain.com
VITE_APP_TITLE=æ¶¦æ‰¬å¤§æ¡¥è¿ç»´ç³»ç»Ÿ
```

---

## ğŸ—„ï¸ æ•°æ®åº“é…ç½®

### SQLiteé…ç½®ï¼ˆé»˜è®¤ï¼‰
```python
# backend/app/core/config.py
DATABASE_URL = "sqlite:///./backend/yunwei_docs.db"
```

### MySQLé…ç½®
```python
DATABASE_URL = "mysql+pymysql://user:password@localhost/runyang_db"
```

### PostgreSQLé…ç½®
```python
DATABASE_URL = "postgresql://user:password@localhost/runyang_db"
```

---

## ğŸš€ æ€§èƒ½ä¼˜åŒ–é…ç½®

### åç«¯ä¼˜åŒ–
```python
# backend/app/core/config.py
# æ–‡ä»¶ä¸Šä¼ é™åˆ¶
MAX_FILE_SIZE = 50 * 1024 * 1024  # 50MB

# æ•°æ®åº“è¿æ¥æ± 
SQLALCHEMY_POOL_SIZE = 10
SQLALCHEMY_MAX_OVERFLOW = 20
```

### å‰ç«¯ä¼˜åŒ–
```typescript
// frontend/vite.config.ts
build: {
  rollupOptions: {
    output: {
      manualChunks: {
        vendor: ['vue', 'vue-router'],
        ui: ['element-plus']
      }
    }
  }
}
```

---

## âš¡ å¸¸è§é…ç½®é—®é¢˜

### CORSé”™è¯¯
**ç°è±¡**: å‰ç«¯æ— æ³•è®¿é—®åç«¯API
**è§£å†³**: æ£€æŸ¥CORSé…ç½®ï¼Œç¡®ä¿å‰ç«¯åœ°å€åœ¨å…è®¸åˆ—è¡¨ä¸­

### ç«¯å£å†²çª
**ç°è±¡**: æœåŠ¡å¯åŠ¨å¤±è´¥ï¼Œæç¤ºç«¯å£è¢«å ç”¨
**è§£å†³**: 
```bash
# WindowsæŸ¥çœ‹ç«¯å£å ç”¨
netstat -ano | findstr :8002

# LinuxæŸ¥çœ‹ç«¯å£å ç”¨
lsof -i :8002
```

### æ–‡ä»¶ä¸Šä¼ å¤±è´¥
**ç°è±¡**: å¤§æ–‡ä»¶ä¸Šä¼ è¶…æ—¶
**è§£å†³**: è°ƒæ•´Nginxå’Œåç«¯çš„ä¸Šä¼ é™åˆ¶
```nginx
client_max_body_size 100M;
```

---

## ğŸ“ é…ç½®æ–‡ä»¶ä½ç½®

```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ .env                    # åç«¯ç¯å¢ƒå˜é‡
â”‚   â”œâ”€â”€ app/core/config.py      # åç«¯æ ¸å¿ƒé…ç½®
â”‚   â””â”€â”€ requirements.txt        # Pythonä¾èµ–
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ .env.production         # å‰ç«¯ç”Ÿäº§ç¯å¢ƒå˜é‡
â”‚   â”œâ”€â”€ vite.config.ts          # å‰ç«¯æ„å»ºé…ç½®
â”‚   â””â”€â”€ package.json           # Node.jsä¾èµ–
â””â”€â”€ docs/                      # é…ç½®æ–‡æ¡£
```

---

## ğŸ” é…ç½®éªŒè¯

ä½¿ç”¨ä»¥ä¸‹è„šæœ¬éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®ï¼š

```bash
# æ£€æŸ¥åç«¯é…ç½®
curl http://localhost:8002/health

# æ£€æŸ¥å‰ç«¯é…ç½®
curl http://localhost:5173

# æ£€æŸ¥CORSé…ç½®
curl -H "Origin: http://localhost:5173" http://localhost:8002/api/v1/auth/me
```

---

## ğŸ“ è·å–æ”¯æŒ

å¦‚æœé…ç½®è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹ `logs/` ç›®å½•ä¸­çš„æ—¥å¿—æ–‡ä»¶
2. å‚è€ƒ `docs/` ç›®å½•ä¸­çš„å…¶ä»–æ–‡æ¡£
3. æ£€æŸ¥ç³»ç»Ÿè¦æ±‚å’Œä¾èµ–å®‰è£…
4. ç¡®è®¤é˜²ç«å¢™å’Œç½‘ç»œè®¾ç½®

æ›´å¤šè¯¦ç»†ä¿¡æ¯è¯·å‚è€ƒå¯¹åº”çš„ä¸“é¡¹é…ç½®æ–‡æ¡£ã€‚
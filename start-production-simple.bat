@echo off
chcp 65001 > nul
cls

echo ====================================================
echo æ¶¦æ‰¬å¤§æ¡¥è¿ç»´æ–‡æ¡£ç®¡ç†ç³»ç»Ÿ - å¿«é€Ÿç”Ÿäº§å¯åŠ¨
echo ====================================================
echo.

:: è®¾ç½®å·¥ä½œç›®å½•
set "ROOT_DIR=%~dp0"

echo [%time%] å¼€å§‹å¯åŠ¨ç”Ÿäº§çŽ¯å¢ƒæœåŠ¡...
echo.

:: ============= å¯åŠ¨åŽç«¯æœåŠ¡ =============
echo [æ­¥éª¤ 1/3] å¯åŠ¨åŽç«¯æœåŠ¡...
cd /d "%ROOT_DIR%backend"
echo [ä¿¡æ¯] æ­£åœ¨å¯åŠ¨FastAPIåŽç«¯æœåŠ¡ (ç«¯å£: 8002)...
start "æ¶¦æ‰¬å¤§æ¡¥è¿ç»´ç³»ç»Ÿ-åŽç«¯" /min cmd /c "python database_integrated_server.py"

:: ç­‰å¾…åŽç«¯å¯åŠ¨
timeout /t 3 /nobreak > nul
echo [æˆåŠŸ] åŽç«¯æœåŠ¡å¯åŠ¨ä¸­...

:: ============= å¯åŠ¨å‰ç«¯æœåŠ¡ =============
echo.
echo [æ­¥éª¤ 2/3] å¯åŠ¨å‰ç«¯æœåŠ¡...
cd /d "%ROOT_DIR%frontend"
echo [ä¿¡æ¯] æ­£åœ¨å¯åŠ¨Vueå‰ç«¯æœåŠ¡ (ç«¯å£: 5173)...
start "æ¶¦æ‰¬å¤§æ¡¥è¿ç»´ç³»ç»Ÿ-å‰ç«¯" /min cmd /c "npm run dev"

:: ç­‰å¾…å‰ç«¯å¯åŠ¨
timeout /t 3 /nobreak > nul
echo [æˆåŠŸ] å‰ç«¯æœåŠ¡å¯åŠ¨ä¸­...

:: ============= æ˜¾ç¤ºç³»ç»Ÿä¿¡æ¯ =============
echo.
echo [æ­¥éª¤ 3/3] ç³»ç»Ÿå¯åŠ¨å®Œæˆï¼
echo.
echo ====================================================
echo                   æœåŠ¡è®¿é—®ä¿¡æ¯
echo ====================================================
echo.
echo ðŸŒ å‰ç«¯ç•Œé¢: http://localhost:5173
echo ðŸ”§ åŽç«¯API:  http://localhost:8002
echo ðŸ“š APIæ–‡æ¡£:  http://localhost:8002/docs
echo.
echo ====================================================
echo                   ç§»åŠ¨ç«¯APIç«¯ç‚¹
echo ====================================================
echo.
echo ðŸ“± ç§»åŠ¨ç«¯è®¤è¯: http://localhost:8002/api/v1/mobile/auth/login
echo ðŸ“„ æ–‡æ¡£æŽ¥å£:   http://localhost:8002/api/v1/mobile/documents/
echo ðŸ¢ èµ„äº§æŽ¥å£:   http://localhost:8002/api/v1/mobile/assets/
echo ðŸŽ¤ è¯­éŸ³æŸ¥è¯¢:   http://localhost:8002/api/v1/voice/query
echo â„¹ï¸  ç³»ç»Ÿä¿¡æ¯:   http://localhost:8002/api/v1/system/info
echo ðŸ’š å¥åº·æ£€æŸ¥:   http://localhost:8002/api/v1/system/health
echo.
echo ====================================================
echo                   ç³»ç»ŸçŠ¶æ€ç›‘æŽ§
echo ====================================================
echo.
echo ðŸ“Š æ•°æ®åˆ†æž:   http://localhost:8002/api/v1/analytics/summary
echo ðŸ” æœç´¢æŽ¥å£:   http://localhost:8002/api/v1/search/
echo âš™ï¸  ç”¨æˆ·è®¾ç½®:   http://localhost:8002/api/v1/settings/profile
echo.
echo ====================================================
echo                   é»˜è®¤ç™»å½•ä¿¡æ¯
echo ====================================================
echo.
echo ðŸ‘¤ ç”¨æˆ·å: admin
echo ðŸ” å¯†ç :   admin123
echo.
echo âš ï¸  é¦–æ¬¡ç™»å½•åŽè¯·ç«‹å³ä¿®æ”¹é»˜è®¤å¯†ç 
echo.
echo ====================================================
echo.

:: è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ï¼ˆå¯é€‰ï¼‰
echo [ä¿¡æ¯] æ˜¯å¦è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨? (è‡ªåŠ¨è·³è¿‡ 10ç§’)
choice /C YN /M "æ‰“å¼€æµè§ˆå™¨ (Y=æ˜¯, N=å¦)" /T 10 /D Y
if not errorlevel 2 (
    echo [ä¿¡æ¯] æ­£åœ¨æ‰“å¼€ç³»ç»Ÿç®¡ç†ç•Œé¢...
    start "" "http://localhost:5173"
    timeout /t 2 /nobreak > nul
    echo [ä¿¡æ¯] æ­£åœ¨æ‰“å¼€APIæ–‡æ¡£...
    start "" "http://localhost:8002/docs"
)

echo.
echo ====================================================
echo                   æ³¨æ„äº‹é¡¹
echo ====================================================
echo.
echo âœ… æœåŠ¡å·²åœ¨åŽå°è¿è¡Œï¼Œå…³é—­æ­¤çª—å£ä¸ä¼šåœæ­¢æœåŠ¡
echo ðŸ›‘ å¦‚éœ€åœæ­¢æœåŠ¡ï¼Œè¯·è¿è¡Œ: stop-services.bat
echo ðŸ”„ å¦‚éœ€é‡å¯æœåŠ¡ï¼Œè¯·å…ˆåœæ­¢åŽé‡æ–°è¿è¡Œæ­¤è„šæœ¬
echo ðŸ“ ç³»ç»Ÿæ—¥å¿—ä½ç½®: backend/logs/
echo ðŸ’¾ æ•°æ®åº“ä½ç½®: backend/yunwei_docs.db
echo.

echo [%time%] ç”Ÿäº§çŽ¯å¢ƒå¯åŠ¨å®Œæˆï¼
echo.
echo æŒ‰ä»»æ„é”®å…³é—­å¯åŠ¨è„šæœ¬ï¼ˆæœåŠ¡å°†ç»§ç»­è¿è¡Œï¼‰...
pause > nul

:: è¿”å›žåŽŸç›®å½•
cd /d "%ROOT_DIR%"